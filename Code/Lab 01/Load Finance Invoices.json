{"name":"Load Finance Invoices","ppdf:dataflowId":"e05fcb5a-1102-4d19-aa96-fe03fee9ec9c","ppdf:owner":{"tenantId":"be1cac13-6575-4f8e-a40d-fcc2d89da64f","userId":"30ce0047-3c19-4ba2-9b46-d244683547fd"},"ppdf:fastCopy":false,"version":"1.0","culture":"en-US","modifiedTime":"2024-08-07T09:48:01.5885471+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"Sales":{"queryId":"03bdbb35-1982-4077-bf46-6e871a8dc424","queryName":"Sales"},"Sample file":{"queryId":"15d238a2-4cee-45ee-b754-93907c662100","queryName":"Sample file","queryGroupId":"9d8ebae0-5449-4943-a692-89da94d555d8"},"Parameter":{"queryId":"bb0766a1-9f68-4d91-bd9c-75370cd2c339","queryName":"Parameter","queryGroupId":"9d8ebae0-5449-4943-a692-89da94d555d8"},"Transform Sample file":{"queryId":"381447cb-1f88-4630-b461-609929289291","queryName":"Transform Sample file","queryGroupId":"3a421c14-438e-47ff-a70e-a31f90984043"},"Transform file":{"queryId":"5bc07290-9a40-4330-a4b6-63d60bef0c8c","queryName":"Transform file","queryGroupId":"9d8ebae0-5449-4943-a692-89da94d555d8"},"Sales_DataDestination":{"queryId":"e7bf0dba-ec0c-4824-9840-6e6c46d539cd","queryName":"Sales_DataDestination"},"Sales_WriteToDataDestination":{"queryId":"fd6792bb-bd12-4e05-adee-9836e780505d","queryName":"Sales_WriteToDataDestination"},"Sales_TransformForWriteToDataDestination":{"queryId":"07b5ed8a-a413-46e9-a516-f31bc6a84c9b","queryName":"Sales_TransformForWriteToDataDestination"}},"document":"section Section1;\r\nshared Sales = let\r\n  Source = Lakehouse.Contents(null){[workspaceId = \"110b5b9f-aab4-4cad-894c-481628e0e255\"]}[Data]{[lakehouseId = \"457e8793-a3f7-4426-b000-fa9369010631\"]}[Data],\r\n  #\"Navigation 1\" = Source{[Id = \"Files\", ItemKind = \"Folder\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"Finance\"]}[Content],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Name = \"Sales\"]}[Content],\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Navigation 3\", {{\"Content\", type binary}}),\r\n  #\"Filtered hidden files\" = Table.SelectRows(#\"Changed column type\", each [Attributes]?[Hidden]? <> true),\r\n  #\"Invoke custom function\" = Table.AddColumn(#\"Filtered hidden files\", \"Transform file\", each #\"Transform file\"([Content])),\r\n  #\"Removed other columns\" = Table.SelectColumns(#\"Invoke custom function\", {\"Transform file\"}),\r\n  #\"Expanded table column\" = Table.ExpandTableColumn(#\"Removed other columns\", \"Transform file\", Table.ColumnNames(#\"Transform file\"(#\"Sample file\"))),\r\n  #\"Changed column type 1\" = Table.TransformColumnTypes(#\"Expanded table column\", {{\"Invoice\", Int64.Type}, {\"Invoice Date\", type date}, {\"Customer\", type text}, {\"Contact\", type text}, {\"Invoice Amount\", type number}}),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Changed column type 1\", {{\"Invoice Date\", \"InvoiceDate\"}, {\"Invoice Amount\", \"InvoiceAmount\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared #\"Sample file\" = let\r\n  Source = Lakehouse.Contents(null){[workspaceId = \"110b5b9f-aab4-4cad-894c-481628e0e255\"]}[Data]{[lakehouseId = \"457e8793-a3f7-4426-b000-fa9369010631\"]}[Data],\r\n  #\"Navigation 1\" = Source{[Id = \"Files\", ItemKind = \"Folder\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"Finance\"]}[Content],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Name = \"Sales\"]}[Content],\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Navigation 3\", {{\"Content\", type binary}}),\r\n  #\"Filtered hidden files\" = Table.SelectRows(#\"Changed column type\", each [Attributes]?[Hidden]? <> true),\r\n  Navigation = #\"Filtered hidden files\"{0}[Content]\r\nin\r\n  Navigation;\r\nshared Parameter = let\r\n  Parameter = #\"Sample file\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type binary, BinaryIdentifier = #\"Sample file\"]\r\nin\r\n  Parameter;\r\nshared #\"Transform Sample file\" = let\r\n  Source = Csv.Document(Parameter, [Delimiter = \",\", Columns = 5, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\";\r\n[FunctionQueryBinding = \"{\"\"exemplarFormulaName\"\":\"\"Transform Sample file\"\"}\"]\r\nshared #\"Transform file\" = let\r\n  #\"Transform file\" = (Parameter as binary) => let\r\n  Source = Csv.Document(Parameter, [Delimiter = \",\", Columns = 5, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\"\r\nin\r\n  #\"Transform file\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared Sales_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"110b5b9f-aab4-4cad-894c-481628e0e255\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"457e8793-a3f7-4426-b000-fa9369010631\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Finance_Invoices\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Invoice = nullable Int64.Type, InvoiceDate = nullable Date.Type, Customer = nullable Text.Type, Contact = nullable Text.Type, InvoiceAmount = nullable Number.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"DefaultStaging\"]\r\nshared Sales_WriteToDataDestination = let\r\n  Sales_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Sales_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], Sales_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Sales_WriteToDataDestination;\r\nshared Sales_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(Sales, {\"Invoice\", \"InvoiceDate\", \"Customer\", \"Contact\", \"InvoiceAmount\"})\r\nin\r\n    SourceTable;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"3a421c14-438e-47ff-a70e-a31f90984043\",\"Name\":\"Transform file from Sales\",\"Description\":null,\"ParentId\":null,\"Order\":0},{\"Id\":\"9d8ebae0-5449-4943-a692-89da94d555d8\",\"Name\":\"Helper queries\",\"Description\":null,\"ParentId\":\"3a421c14-438e-47ff-a70e-a31f90984043\",\"Order\":0}]"}]}