{"name":"Load Finance Contacts","ppdf:dataflowId":"263062ad-4f3a-4f89-a3a0-cda129d82abf","ppdf:owner":{"tenantId":"be1cac13-6575-4f8e-a40d-fcc2d89da64f","userId":"30ce0047-3c19-4ba2-9b46-d244683547fd"},"ppdf:fastCopy":false,"version":"1.0","culture":"en-US","modifiedTime":"2024-08-06T15:43:28.3751805+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"CustContacts csv":{"queryId":"f3de3c61-273f-43a3-b3ea-af8c7886373f","queryName":"CustContacts csv"},"NavigationQuery":{"queryId":"65bfba4f-63b0-49a3-ad29-790c5f8b1a0d","queryName":"NavigationQuery","loadEnabled":true},"CustContacts csv_DataDestination":{"queryId":"f9ac6097-8148-4123-ae71-8bc71cfe0910","queryName":"CustContacts csv_DataDestination"},"CustContacts csv_WriteToDataDestination":{"queryId":"36ef2ef6-9f6b-4806-90d5-d5974a28f69e","queryName":"CustContacts csv_WriteToDataDestination"},"CustContacts csv_TransformForWriteToDataDestination":{"queryId":"76a558ae-fa96-4011-9a23-94587ecf9098","queryName":"CustContacts csv_TransformForWriteToDataDestination"}},"document":"section Section1;\r\nshared #\"CustContacts csv\" = let\r\n  Source = Lakehouse.Contents(null){[workspaceId = \"110b5b9f-aab4-4cad-894c-481628e0e255\"]}[Data]{[lakehouseId = \"457e8793-a3f7-4426-b000-fa9369010631\"]}[Data],\r\n  #\"Navigation 1\" = Source{[Id = \"Files\", ItemKind = \"Folder\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"Finance\"]}[Content],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Name = \"CustContacts.csv\"]}[Content],\r\n  #\"Imported CSV\" = Csv.Document(#\"Navigation 3\", [Delimiter = \",\", Columns = 4, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true]),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Promoted headers\", {{\"First name\", \"FirstName\"}, {\"Last name\", \"LastName\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared NavigationQuery = let\r\n  Source = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  #\"From Value\" = Table.FromValue(Source),\r\n  #\"Remove Columns\" = Table.RemoveColumns(#\"From Value\", Table.ColumnsOfType(#\"From Value\", {type table, type record, type list, type nullable binary, type binary, type function}))\r\nin\r\n  #\"Remove Columns\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared #\"CustContacts csv_DataDestination\" = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"110b5b9f-aab4-4cad-894c-481628e0e255\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"457e8793-a3f7-4426-b000-fa9369010631\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Finance_Contacts\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[ContactID = nullable Text.Type, FirstName = nullable Text.Type, LastName = nullable Text.Type, Company = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"DefaultStaging\"]\r\nshared #\"CustContacts csv_WriteToDataDestination\" = let\r\n  #\"CustContacts csv_WriteToDataDestination\" = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = #\"CustContacts csv_DataDestination\"], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], #\"CustContacts csv_TransformForWriteToDataDestination\"), Action.DoNothing}))\r\nin\r\n  #\"CustContacts csv_WriteToDataDestination\";\r\nshared #\"CustContacts csv_TransformForWriteToDataDestination\" = let\r\n    SourceTable = Table.SelectColumns(#\"CustContacts csv\", {\"ContactID\", \"FirstName\", \"LastName\", \"Company\"})\r\nin\r\n    SourceTable;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"NavigationQuery","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"NavigationQuery.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"workspaceId\"]}]"}],"attributes":[{"name":"workspaceId","dataType":"string"},{"name":"workspaceName","dataType":"string"},{"name":"ItemKind","dataType":"string"},{"name":"ItemName","dataType":"string"},{"name":"IsLeaf","dataType":"string"}]}]}